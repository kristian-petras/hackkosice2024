#include <Arduino.h>
#include <display.h>
#include <led.h>
#include <button.h>
#include <buzzer.h>
#include <stream.h>

#define BLOCK_SIZE 4 // Define the size of each block

ShiftDisplay2 display = get_display();

void display_demo(ShiftDisplay2 display) {
    for (int i = 3; i > 0; i--) {
        // store number and show it for 400ms
        display.set(i, ALIGN_CENTER);
        display.show(400);
        // add dot to stored number and show it for 400ms
        display.changeDot(1);
        display.show(400);
    }
    display.set("HOGI"); // store "GO"
}


void setup() {
    Serial.begin(115200);
    init_led();
    init_button();
    init_buzzer();
    display_demo(display);
}

int frequencies[] = { 492, 492, 492, 492, 500, 492, 664, 1328, 656, 656, 664, 1312, 1312, 656, 664, 742, 734, 734, 734, 781, 781, 1555, 1570, 781, 781, 781, 781, 1750, 1742, 1758, 891, 1742, 1961, 992, 1961, 1953, 992, 1953, 1953, 992, 1961, 1961, 992, 1961, 1961, 1961, 992, 1961, 992, 992, 1953, 992, 992, 1953, 992, 992, 1961, 1062, 1039, 1047, 1047, 2094, 1031, 1047, 1047, 1031, 1039, 2125, 1031, 2094, 1062, 1039, 1047, 1047, 1039, 1047, 1047, 2070, 1031, 1039, 1039, 1031, 1961, 1961, 992, 992, 1961, 992, 1953, 1953, 992, 1953, 992, 992, 992, 992, 992, 1000, 1000, 992, 984, 992, 992, 984, 1961, 1961, 992, 1961, 1750, 1742, 1758, 1742, 1742, 883, 1742, 1742, 1742, 1742, 1742, 883, 883, 1750, 1750, 1773, 1742, 1742, 883, 1734, 1734, 1742, 1742, 883, 891, 1742, 781, 781, 1555, 1570, 781, 781, 781, 781, 1750, 1742, 1758, 891, 1742, 781, 781, 1562, 781, 781, 781, 781, 773, 781, 781, 1555, 789, 742, 742, 734, 734, 742, 734, 734, 734, 734, 742, 750, 734, 734, 734, 742, 734, 734, 734, 734, 734, 734, 734, 742, 734, 734, 734, 664, 1328, 656, 656, 664, 1312, 1312, 656, 656, 1312, 664, 1312, 1312, 1320, 664, 664, 664, 664, 656, 1312, 492, 492, 492, 492, 492, 492, 664, 1320, 1312, 656, 664, 1312, 1312, 656, 742, 734, 734, 734, 781, 781, 781, 1578, 781, 781, 781, 781, 1758, 1742, 1742, 891, 1742, 1961, 1961, 992, 1961, 992, 992, 1953, 992, 1961, 1961, 992, 992, 1961, 1961, 1961, 992, 1961, 992, 1953, 1953, 992, 992, 992, 992, 992, 992, 1062, 1039, 1047, 1047, 1039, 1047, 1047, 2078, 1039, 2125, 1031, 1039, 1062, 1062, 1039, 1047, 1047, 2094, 1047, 1047, 1031, 1039, 2125, 1031, 1039, 1961, 1961, 992, 1961, 992, 992, 1953, 992, 992, 1953, 992, 992, 992, 992, 1953, 1000, 1000, 1953, 992, 992, 992, 1961, 1961, 992, 992, 1758, 1742, 1750, 883, 1742, 1742, 883, 1742, 1742, 883, 1742, 1742, 883, 1750, 1742, 1758, 1758, 1742, 1742, 1742, 1742, 1742, 1742, 1742, 1773, 1742, 1742, 781, 781, 1562, 781, 781, 781, 781, 1758, 1742, 1742, 1773, 1742, 1742, 781, 781, 1578, 781, 781, 781, 781, 781, 781, 781, 1555, 734, 742, 734, 734, 734, 734, 734, 734, 734, 734, 750, 742, 734, 734, 742, 734, 734, 742, 734, 734, 734, 734, 734, 742, 734, 734, 656, 664, 1320, 1312, 656, 1312, 1312, 1312, 664, 1312, 1312, 664, 1312, 1312, 656, 664, 664, 664 };
int d = 64;

void loop() {
    display.show(1000);
    display.set("HOGI");
    delay(1000);
    display.update();
    read_data();
    play(frequencies, d); // temporary, will make it non-blocking later
}
